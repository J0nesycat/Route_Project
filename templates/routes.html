{% extends 'base.html' %}
{% load static %}
{% block content %}

<h2>××¢×¨×›×ª ×œ×‘× ×™×™×ª ××¡×œ×•×œ×™×</h2>

<form id="route-form" method="POST" action="{% url 'generate_routes' %}">
    {% csrf_token %}
    <label for="summary_date">×‘×—×¨ ×™×•× ×”×¤×¦×”:</label>
    <select name="summary_date" id="summary_date" required>
        {% for summary in summaries %}
            <option value="{{ summary.date }}">{{ summary.date|date:"F j, Y" }}</option>
        {% endfor %}
    </select>

    <button type="submit" id="generate-button">ğŸš› ×‘× ×™×™×ª ××¡×œ×•×œ ×—×“×©</button>
    <button type="button" id="load-button">ğŸ“¦ ×ª×¦×•×’×ª ××¡×œ×•×œ ×§×™×™×</button>
</form>

{% if error %}
    <p style="color: red;">âŒ {{ error }}</p>
{% endif %}

<h3>××¡×œ×•×œ×™×</h3>
<ul id="route-list" style="list-style: none; padding-right: 0;" dir="rtl"></ul>
<p id="no-routes-msg" style="display: none;">×œ× × ××¦××• ××¡×œ×•×œ×™× ×œ×ª××¨×™×š ×–×” ×œ×—×¥ ×¢×œ ×‘× ×™×™×ª ××¡×œ×•×œ </p>

<h2>×ª×¦×•×’×ª ××¤×”</h2>
<div id="map" style="width: 100%; height: 500px;"></div>

<!-- Fullscreen loading overlay -->
<div id="loading-overlay">
    <!-- Background video -->
    <video class="bg-video" autoplay muted loop playsinline>
        <source src="{% static 'videos/loading.mp4' %}" type="video/mp4">
        ×”×“×¤×“×¤×Ÿ ×©×œ×š ×œ× ×ª×•××š ×‘×¡×¨×˜×•× ×™×
    </video>

    <!-- Foreground content -->
    <div class="loading-message">
        <div class="loading-text">
            ×× × ×”××ª×Ÿ ×‘×ª×”×œ×™×š ×‘× ×™×™×ª ××¡×œ×•×œ
            <span class="loading-dots"></span>
        </div>
    </div>
</div>



{% block extra_head %}
    <link rel="stylesheet" href="{% static 'css/routes.css' %}">
    <link href="https://api.mapbox.com/mapbox-gl-js/v2.12.0/mapbox-gl.css" rel="stylesheet" />
    <script src="https://api.mapbox.com/mapbox-gl-js/v2.12.0/mapbox-gl.js"></script>
    <script>
        window.mapbox_token = "{{ mapbox_token }}";
    </script>
    <script src="{% static 'js/routes.js' %}"></script>
{% endblock %}

{% endblock %}
